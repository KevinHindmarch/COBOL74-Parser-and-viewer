{
  "name": "CBTRN03C",
  "attributes": {
    "type": "Program"
  },
  "children": [
    {
      "name": "IDENTIFICATION",
      "attributes": {
        "type": "Division"
      },
      "children": []
    },
    {
      "name": "ENVIRONMENT",
      "attributes": {
        "type": "Division"
      },
      "children": [
        {
          "name": "INPUT-OUTPUT",
          "attributes": {
            "type": "Section"
          },
          "children": []
        }
      ]
    },
    {
      "name": "DATA",
      "attributes": {
        "type": "Division"
      },
      "children": [
        {
          "name": "FILE",
          "attributes": {
            "type": "Section"
          },
          "children": [
            {
              "name": "FD-TRANFILE-REC",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "FD-TRANS-DATA",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-TRAN-PROC-TS",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-FILLER",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-CARDXREF-REC",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "FD-XREF-CARD-NUM",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-XREF-DATA",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-TRANTYPE-REC",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "FD-TRAN-TYPE",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-TRAN-DATA",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-TRAN-CAT-RECORD",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "FD-TRAN-CAT-KEY",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": null
              }
            },
            {
              "name": "FD-TRAN-TYPE-CD",
              "attributes": {
                "type": "DataItem",
                "level": 10,
                "picture": "X("
              }
            },
            {
              "name": "FD-TRAN-CAT-CD",
              "attributes": {
                "type": "DataItem",
                "level": 10,
                "picture": "9("
              }
            },
            {
              "name": "FD-TRAN-CAT-DATA",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FD-REPTFILE-REC",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": "X("
              }
            },
            {
              "name": "FD-DATEPARM-REC",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": "X("
              }
            }
          ]
        },
        {
          "name": "WORKING-STORAGE",
          "attributes": {
            "type": "Section"
          },
          "children": [
            {
              "name": "TRANFILE-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "TRANFILE-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TRANFILE-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "CARDXREF-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "CARDXREF-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "CARDXREF-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TRANTYPE-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "TRANTYPE-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TRANTYPE-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TRANCATG-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "TRANCATG-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TRANCATG-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TRANREPT-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "REPTFILE-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "REPTFILE-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "DATEPARM-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "DATEPARM-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "DATEPARM-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "WS-DATEPARM-RECORD",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "WS-START-DATE",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "FILLER",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "WS-END-DATE",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "WS-REPORT-VARS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "WS-FIRST-TIME",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "WS-LINE-COUNTER",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "9("
              }
            },
            {
              "name": "WS-PAGE-SIZE",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "9("
              }
            },
            {
              "name": "WS-BLANK-LINE",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "WS-PAGE-TOTAL",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": null
              }
            },
            {
              "name": "WS-ACCOUNT-TOTAL",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": null
              }
            },
            {
              "name": "WS-GRAND-TOTAL",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": null
              }
            },
            {
              "name": "WS-CURR-CARD-NUM",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X("
              }
            },
            {
              "name": "IO-STATUS",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "IO-STAT1",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "IO-STAT2",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TWO-BYTES-BINARY",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": "9("
              }
            },
            {
              "name": "TWO-BYTES-ALPHA",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "TWO-BYTES-LEFT",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "TWO-BYTES-RIGHT",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "X"
              }
            },
            {
              "name": "IO-STATUS-04",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "IO-STATUS-0401",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "9"
              }
            },
            {
              "name": "IO-STATUS-0403",
              "attributes": {
                "type": "DataItem",
                "level": 5,
                "picture": "999"
              }
            },
            {
              "name": "APPL-RESULT",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "APPL-AOK",
              "attributes": {
                "type": "DataItem",
                "level": 88,
                "picture": null
              }
            },
            {
              "name": "APPL-EOF",
              "attributes": {
                "type": "DataItem",
                "level": 88,
                "picture": null
              }
            },
            {
              "name": "END-OF-FILE",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": "X("
              }
            },
            {
              "name": "ABCODE",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            },
            {
              "name": "TIMING",
              "attributes": {
                "type": "DataItem",
                "level": 1,
                "picture": null
              }
            }
          ]
        }
      ]
    },
    {
      "name": "PROCEDURE",
      "attributes": {
        "type": "Division"
      },
      "children": [
        {
          "name": "PARAGRAPHS",
          "attributes": {
            "type": "Section"
          },
          "children": [
            {
              "name": "GOBACK",
              "attributes": {
                "type": "Paragraph",
                "statements": 0
              },
              "children": []
            },
            {
              "name": "0550-DATEPARM-READ",
              "attributes": {
                "type": "Paragraph",
                "statements": 18
              },
              "children": [
                {
                  "name": "READ",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "DATE-PARMS-FILE INTO WS-DATEPARM-RECORD."
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "DATEPARM-STATUS = '00'"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "0 TO APPL-RESULT"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "DATEPARM-STATUS = '10'"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "16 TO APPL-RESULT"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "12 TO APPL-RESULT."
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "APPL-AOK"
                  }
                },
                {
                  "name": "DISPLAY",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "'Reporting from ' WS-START-DATE"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "APPL-EOF"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "'Y' TO END-OF-FILE"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "DISPLAY",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "'ERROR READING DATEPARM FILE'"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "DATEPARM-STATUS TO IO-STATUS"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "9910-DISPLAY-IO-STATUS"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "9999-ABEND-PROGRAM."
                  }
                }
              ]
            },
            {
              "name": "1000-PROCESS-TRANSACTIONS",
              "attributes": {
                "type": "Paragraph",
                "statements": 35
              },
              "children": [
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1000-TRANFILE-GET-NEXT."
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "END-OF-FILE = 'N'"
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-PROC-TS (1:10) >= WS-START-DATE"
                  }
                },
                {
                  "name": "AND",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-PROC-TS (1:10) <= WS-END-DATE"
                  }
                },
                {
                  "name": "NEXT",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "SENTENCE"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "GO",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TO 1000-PROCESS-TRANSACTIONS-EXIT."
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "END-OF-FILE = 'N'"
                  }
                },
                {
                  "name": "DISPLAY",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-RECORD"
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "WS-CURR-CARD-NUM NOT= TRAN-CARD-NUM"
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "WS-FIRST-TIME = 'N'"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1120-WRITE-ACCOUNT-TOTALS"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "NEXT",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "SENTENCE"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-CARD-NUM TO WS-CURR-CARD-NUM"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-CARD-NUM TO FD-XREF-CARD-NUM"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1500-A-LOOKUP-XREF"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "NEXT",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "SENTENCE."
                  }
                },
                {
                  "name": "IF",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "END-OF-FILE = 'N'"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-TYPE-CD OF TRAN-RECORD TO FD-TRAN-TYPE"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1500-B-LOOKUP-TRANTYPE"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-TYPE-CD OF TRAN-RECORD"
                  }
                },
                {
                  "name": "TO",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "FD-TRAN-TYPE-CD OF FD-TRAN-CAT-KEY"
                  }
                },
                {
                  "name": "MOVE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-CAT-CD OF TRAN-RECORD"
                  }
                },
                {
                  "name": "TO",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "FD-TRAN-CAT-CD OF FD-TRAN-CAT-KEY"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1500-C-LOOKUP-TRANCATG"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1100-WRITE-TRANSACTION-REPORT"
                  }
                },
                {
                  "name": "ELSE",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "DISPLAY",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "'TRAN-AMT ' TRAN-AMT"
                  }
                },
                {
                  "name": "DISPLAY",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "'WS-PAGE-TOTAL'  WS-PAGE-TOTAL"
                  }
                },
                {
                  "name": "ADD",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "TRAN-AMT TO WS-PAGE-TOTAL"
                  }
                },
                {
                  "name": "WS-ACCOUNT-TOTAL",
                  "attributes": {
                    "type": "Statement",
                    "arguments": ""
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1110-WRITE-PAGE-TOTALS"
                  }
                },
                {
                  "name": "PERFORM",
                  "attributes": {
                    "type": "Statement",
                    "arguments": "1110-WRITE-GRAND-TOTALS."
                  }
                }
              ]
            },
            {
              "name": "1000-PROCESS-TRANSACTIONS-EXIT",
              "attributes": {
                "type": "Paragraph",
                "statements": 0
              },
              "children": []
            },
            {
              "name": "EXIT",
              "attributes": {
                "type": "Paragraph",
                "statements": 0
              },
              "children": []
            }
          ]
        }
      ]
    }
  ]
}